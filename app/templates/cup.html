{% extends "base.html" %}

{% block content %}
<div class="cup-container container-sm">
    <h1 class="text-center mb-2">ğŸ† ÙƒØ£Ø³ Ø§Ù„Ø´Ù‡Ø± (Head-to-Head)</h1>

    {% if not matchups %}
    <div class="empty-state">
        <div class="icon">ğŸ˜´</div>
        <h3>Ø§Ù„ÙƒØ£Ø³ ÙÙŠ ÙØªØ±Ø© Ø±Ø§Ø­Ø©</h3>
        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø§ÙØ³Ø§Øª ÙƒØ£Ø³ Ø­Ø§Ù„ÙŠØ§Ù‹. Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨ Ø­ØªÙ‰ ÙŠØªÙ… Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø¨Ø·ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©!</p>
    </div>
    {% else %}
    <div class="cup-bracket">
        {% set current_round = None %}
        {% for matchup in matchups %}
        {% if current_round != matchup.round_name %}
        <h2 class="text-center"
            style="background: #2c3e50; color: white; padding: 0.75rem; border-radius: var(--radius-md); margin-top: 2rem; font-size: 1.2rem;">
            {{ matchup.round_name }}
        </h2>
        {% set current_round = matchup.round_name %}
        {% endif %}

        <div
            class="card matchup-card flex-between mb-1 {% if matchup.is_active %}active-matchup{% else %}resolved-matchup{% endif %}">

            <div class="player player1 text-center {% if not matchup.is_active and matchup.winner_id != matchup.player1_id %}loser{% endif %}"
                style="flex: 1;">
                <div class="player-name {% if matchup.winner_id == matchup.player1_id %}text-success{% endif %}"
                    style="font-weight: bold; font-size: 1.2rem;">
                    {{ matchup.player1.name }}
                    {% if matchup.winner_id == matchup.player1_id %} ğŸ† {% endif %}
                </div>
                <div class="text-secondary" style="font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·: {{ matchup.player1.total_points }}
                </div>
            </div>

            <div class="vs" style="padding: 0 20px; font-weight: bold; text-align: center;">
                {% if matchup.is_active %}
                <span class="vs-badge active-vs">VS<br><small>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</small></span>
                {% else %}
                <span class="vs-badge resolved-vs">Ø§Ù†ØªÙ‡Øª</span>
                {% endif %}
            </div>

            <div class="player player2 text-center {% if not matchup.is_active and matchup.winner_id != matchup.player2_id %}loser{% endif %}"
                style="flex: 1;">
                <div class="player-name {% if matchup.winner_id == matchup.player2_id %}text-success{% endif %}"
                    style="font-weight: bold; font-size: 1.2rem;">
                    {% if matchup.winner_id == matchup.player2_id %} ğŸ† {% endif %}
                    {{ matchup.player2.name }}
                </div>
                <div class="text-secondary" style="font-size: 0.9rem;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø·: {{ matchup.player2.total_points }}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="card mb-2"
        style="background: var(--hover-bg); border-right: 5px solid var(--accent-color); padding: 1.5rem; box-shadow: var(--shadow-md);">
        <h4
            style="margin-top: 0; color: var(--accent-color); font-size: 1.2rem; margin-bottom: 15px; font-weight: 800;">
            ğŸ“œ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ÙƒØ£Ø³:</h4>
        <ul style="font-size: 1rem; margin-bottom: 0; padding-right: 25px; line-height: 1.8;">
            <li style="margin-bottom: 10px;">ÙŠØªÙ… ØªØ£Ù‡ÙŠÙ„ Ø£Ø¹Ù„Ù‰ 10 Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙÙŠ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø§Ù….</li>
            <li style="margin-bottom: 10px;">Ø§Ù„Ù…ÙˆØ§Ø¬Ù‡Ø§Øª ØªØªÙ… Ø¨Ù†Ø¸Ø§Ù… Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…ØºÙ„ÙˆØ¨ (Head-to-Head).</li>
            <li style="margin-bottom: 10px;"><strong style="color: var(--accent-color);">ÙŠØªÙ… Ø­Ø³Ù… Ø§Ù„Ù…ÙˆØ§Ø¬Ù‡Ø©
                    ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</strong> Ù…ØªÙ‰ Ù„Ø¹Ø¨ Ø§Ù„Ø·Ø±ÙØ§Ù† Ù…Ø¹Ø§Ù‹ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©ØŒ ÙˆØ§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ø£Ø¹Ù„Ù‰ ØªÙ‚Ø±Ø± Ø§Ù„ÙØ§Ø¦Ø²!</li>
            <li>ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø§Ø¯Ù„ ÙÙŠ Ù…ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ÙƒØ£Ø³ØŒ ÙŠØªØ£Ù‡Ù„ ØµØ§Ø­Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø£Ø¹Ù„Ù‰ ÙÙŠ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø§Ù… Ù„Ø­Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ù.</li>
        </ul>
    </div>
</div>

<style>
    @keyframes pulse {
        0% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.7);
        }

        70% {
            transform: scale(1.05);
            box-shadow: 0 0 0 10px rgba(231, 76, 60, 0);
        }

        100% {
            transform: scale(1);
            box-shadow: 0 0 0 0 rgba(231, 76, 60, 0);
        }
    }

    .active-matchup {
        border-right: 5px solid var(--warning-color);
    }

    .resolved-matchup {
        border-right: 5px solid var(--success-color);
    }

    .loser {
        opacity: 0.5;
        filter: grayscale(100%);
    }

    .player-name {
        color: var(--heading-color);
    }

    .vs-badge {
        display: inline-block;
        padding: 5px 15px;
        border-radius: 20px;
    }

    .active-vs {
        background: var(--danger-color);
        color: white;
        font-size: 0.9rem;
        animation: pulse 2s infinite;
    }

    .resolved-vs {
        color: var(--color-gray-500);
        font-size: 1.2rem;
    }
</style>
{% endblock %}