{% extends "base.html" %}

{% block content %}
<h1>ğŸ† ØªØ±ØªÙŠØ¨ Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ø¨Ø·Ø§Ù„</h1>

<div class="text-center mb-1">
    <button id="share-leaderboard" class="btn btn-primary">Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªØ±ØªÙŠØ¨ ğŸ“¤ğŸ“¸</button>
</div>

<div id="capture-area" style="padding: 1rem;">

    <!-- Dynamic Banners -->
    <div class="banners-container mb-1">
        {% if latest_hof %}
        <div class="banner-card banner-gold">
            ğŸŒŸ Ø¨Ø·Ù„ Ø´Ù‡Ø± {{ latest_hof.month_year }}: {{ latest_hof.player.name }} ({{ latest_hof.points_scored }} Ù†Ù‚Ø·Ø©)
            ğŸŒŸ
        </div>
        {% endif %}

        {% if next_cup %}
        <div class="banner-card banner-danger">
            ğŸ† Ù…ÙˆØ¹Ø¯ Ø§Ù„ÙƒØ£Ø³ Ø§Ù„Ù‚Ø§Ø¯Ù…: {{ next_cup.player1.name }} ğŸ†š {{ next_cup.player2.name }} ğŸ†
        </div>
        {% endif %}
    </div>

    {% if not players %}
    <div class="empty-state">
        <div class="icon">ğŸœï¸</div>
        <h3>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¨Ø¹Ø¯</h3>
        <p>Ø§Ù„Ø³Ø§Ø­Ø© Ø®Ø§Ù„ÙŠØ©! Ø§Ø¨Ø¯Ø£ Ø¨ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„ Ù…Ø¨Ø§Ø±Ø§Ø© Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„ØªØ¨Ø¯Ø£ Ø§Ù„Ø¥Ø«Ø§Ø±Ø©.</p>
    </div>
    {% else %}
    <!-- Leaderboard Category Tabs -->
    <div class="tabs-container flex-center gap-2 mb-1" style="flex-wrap: wrap;">
        <button class="tab-btn active" data-sort="points">Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¹Ø§Ù…</button>
        <button class="tab-btn" data-sort="goals">Ø§Ù„Ù‡Ø¯Ø§ÙÙŠÙ†</button>
        <button class="tab-btn" data-sort="assists">ØµÙ†Ø§Ø¹ Ø§Ù„Ù„Ø¹Ø¨</button>
        <button class="tab-btn" data-sort="saves">Ø§Ù„Ø­Ø±Ø§Ø³</button>
    </div>

    <div class="table-responsive">
        <table>
            <thead>
                <tr>
                    <th>Ø§Ù„Ù…Ø±ÙƒØ²</th>
                    <th>Ø§Ù„Ù„Ø§Ø¹Ø¨</th>
                    <th>Ø§Ù„ÙÙˆØ±Ù…Ø©</th>
                    <th>Ø§Ù„Ù†Ù‚Ø§Ø·</th>
                    <th>Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</th>
                    <th>Ø§Ù„Ø£Ø³ÙŠØ³Øª</th>
                    <th>Ø§Ù„ØªØµØ¯ÙŠØ§Øª</th>
                    <th>Ø´Ø¨Ø§Ùƒ Ù†Ø¸ÙŠÙØ©</th>
                </tr>
            </thead>
            <tbody id="leaderboard-body">
                {% for player in players %}
                <tr data-points="{{ player.total_points }}" data-goals="{{ player.total_goals }}"
                    data-assists="{{ player.total_assists }}" data-saves="{{ player.total_saves }}">
                    <td data-label="Ø§Ù„Ù…Ø±ÙƒØ²" class="rank-col">
                        <span class="trend-indicator" style="margin-inline-end: 0.5rem;">
                            {% if player.total_points > 0 %}
                            {% if player.previous_rank == 0 or player.previous_rank == loop.index %}
                            <span class="text-secondary trend-icon">â–</span>
                            {% elif loop.index < player.previous_rank %} <span style="color: var(--positive-color);"
                                class="trend-icon" title="ØµØ¹Ø¯ {{ player.previous_rank - loop.index }} Ù…Ø±ÙƒØ²">â¬†ï¸</span>
                        {% else %}
                        <span style="color: var(--negative-color);" class="trend-icon"
                            title="ØªØ±Ø§Ø¬Ø¹ {{ loop.index - player.previous_rank }} Ù…Ø±ÙƒØ²">â¬‡ï¸</span>
                        {% endif %}
                        {% else %}
                        <span class="text-secondary trend-icon">â–</span>
                        {% endif %}
                        </span>
                        {{ loop.index }}
                        {% if player.total_points > 0 %}
                        {% if loop.index == 1 %}ğŸ¥‡{% elif loop.index == 2 %}ğŸ¥ˆ{% elif loop.index == 3 %}ğŸ¥‰{% endif %}
                        {% endif %}
                    </td>
                    <td data-label="Ø§Ù„Ù„Ø§Ø¹Ø¨">
                        <a href="/player/{{ player.id }}" style="font-weight: bold;">{{ player.name }}</a>
                        {% if player.total_points > 0 and loop.index == 1 %}<span class="crown">ğŸ‘‘</span>{% endif %}
                    </td>
                    <td data-label="Ø§Ù„ÙÙˆØ±Ù…Ø©">{{ player.form }}</td>
                    <td data-label="Ø§Ù„Ù†Ù‚Ø§Ø·"><strong>{{ player.total_points }}</strong></td>
                    <td data-label="Ø§Ù„Ø£Ù‡Ø¯Ø§Ù">{{ player.total_goals }}</td>
                    <td data-label="Ø§Ù„Ø£Ø³ÙŠØ³Øª">{{ player.total_assists }}</td>
                    <td data-label="Ø§Ù„ØªØµØ¯ÙŠØ§Øª">{{ player.total_saves }}</td>
                    <td data-label="Ø´Ø¨Ø§Ùƒ Ù†Ø¸ÙŠÙØ©">{{ player.total_clean_sheets }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
</div> <!-- End capture-area -->

<script src="/static/js/leaderboard.js"></script>
{% endblock %}